# SonarQube / SonarCloud 專案設定
# Free-CRM - ISO 27001 程式碼品質管理
#
# 設定說明：
# - SonarCloud: 需設定 sonar.organization（從 sonarcloud.io 取得）
# - SonarQube: 不需要 organization，僅需 projectKey

# 專案識別
sonar.projectKey=beckyeh8888_free-crm
sonar.organization=beckyeh8888
sonar.projectName=Free-CRM
sonar.projectVersion=0.1.0

# 原始碼設定
sonar.sources=src
sonar.tests=tests
sonar.sourceEncoding=UTF-8

# TypeScript/JavaScript 設定
sonar.typescript.tsconfigPath=tsconfig.json
sonar.javascript.lcov.reportPaths=coverage/lcov.info

# 排除檔案
sonar.exclusions=\
  **/node_modules/**,\
  **/*.test.ts,\
  **/*.test.tsx,\
  **/*.spec.ts,\
  **/*.spec.tsx,\
  **/coverage/**,\
  **/.next/**,\
  **/storybook-static/**,\
  **/*.stories.tsx,\
  **/prisma/migrations/**

# 測試檔案排除 (不計入覆蓋率)
sonar.test.exclusions=\
  **/tests/**,\
  **/*.test.ts,\
  **/*.test.tsx,\
  **/*.spec.ts,\
  **/*.spec.tsx,\
  **/*.stories.tsx

# 覆蓋率排除 (與 vitest.config.ts coverage.include/exclude 對齊)
# 僅 src/components, src/hooks, src/lib, src/services 納入覆蓋率計算
sonar.coverage.exclusions=\
  **/node_modules/**,\
  **/.next/**,\
  **/prisma/migrations/**,\
  **/*.config.ts,\
  **/*.config.js,\
  **/*.d.ts,\
  src/app/**,\
  src/middleware.ts,\
  src/types/**,\
  src/lib/auth.ts,\
  src/lib/db.ts,\
  src/lib/prisma.ts,\
  src/lib/inngest/**,\
  src/**/index.ts

# 品質門檻 (Quality Gate)
# 這些由 SonarCloud 專案設定控制，此處為參考
# - 覆蓋率 >= 80%
# - 重複程式碼 <= 3%
# - 可維護性評級 A
# - 可靠性評級 A
# - 安全性評級 A

# 忽略 Tailwind CSS 4 @source 語法的誤報
sonar.issue.ignore.multicriteria=tailwindSource,commandPaletteListbox,commandPaletteOption
sonar.issue.ignore.multicriteria.tailwindSource.ruleKey=css:S4662
sonar.issue.ignore.multicriteria.tailwindSource.resourceKey=src/app/globals.css

# 忽略 CommandPalette ARIA 角色誤報 - 命令面板需要自訂 ARIA 角色，無法使用原生 select/option
# W3C ARIA Authoring Practices 允許此模式用於自訂命令面板
sonar.issue.ignore.multicriteria.commandPaletteListbox.ruleKey=typescript:S6819
sonar.issue.ignore.multicriteria.commandPaletteListbox.resourceKey=src/components/CommandPalette/CommandPalette.tsx
sonar.issue.ignore.multicriteria.commandPaletteOption.ruleKey=typescript:S6819
sonar.issue.ignore.multicriteria.commandPaletteOption.resourceKey=src/components/CommandPalette/CommandPalette.tsx

# 安全熱點審查
sonar.security.hotspots.inheritedRulesDisabled=false

# 分支分析
sonar.branch.name=${GITHUB_REF_NAME}
